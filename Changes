		CHANGES IN APE VERSION 1.8-2


NEW FEATURES

    o The new function mlphylo() fits a phylogenetic tree by maximum
      likelihood from DNA sequences. Its companion function DNAmodel()
      is used to define the substitution model which may include
      partitioning. There are methods for logLik(), deviance(), and
      AIC(), and the summary() method has been extended to display in
      a friendly way the results of this model fitting. Currently, the
      functionality is limited to estimating the substitution and
      associated parameters and computing the likelihood.

    o The new function drop1.compar.gee (used as, e.g.,  drop1(m))
      tests for single effects in GEE-based comparative method. A
      warning message is printed if there is not enough degrees of
      freedom.


BUG FIXES

    o An error message was sometimes issued by plot.multi.tree()
      though with no consequence.



		CHANGES IN APE VERSION 1.8-1


NEW FEATURES

    o There is a new plot method for lists of trees (objects of class
      "multi.tree"): it calls plot.phylo() internally and is
      documented on the same help page.


BUG FIXES

    o A bug was fixed in the C code that analyzes bipartitions: this
      has impact on several functions like prop.part, prop.clades,
      boot.phylo, or consensus.

    o root() did not work correctly when the specified outgroup had
      more than one element: this is fixed.

    o dist.dna() sometimes returned a warning inappropriately: this
      has been corrected.

    o If the distance object given to nj() had no rownames, nj()
      returned a tree with no tip labels: it now returns tips labelled
      "1", "2", ..., corresponding to the row numbers.


OTHER CHANGES

    o nj() has been slightly changed so that tips with a zero distance
      are first aggregated with zero-lengthed branches; the usual NJ
      procedure is then performed on a distance matrix without 0's.



		CHANGES IN APE VERSION 1.8


NEW FEATURES

    o The new function chronopl() estimates dates using the penalized
      likelihood method by Sanderson (2002; Mol. Biol. Evol., 19:101).

    o The new function consensus() calculates the consensus tree of a
      list of trees.

    o The new function evolve.phylo() simulates the evolution of
      continuous characters along a phylogeny under a Brownian model.

    o The new plot method for objects of class "ancestral" displays a
      tree together with ancestral values, as returned by the above
      function.

    o The new function as.phylo.formula() returns a phylogeny from a
      set of nested taxonomic variables given as a formula.

    o The new function read.caic() reads trees in CAIC format.

    o The new function tiplabels() allows to add labels to the tips
      of a tree using text or plotting symbols in a flexible way.

    o The new function unroot() unroots a phylogeny.

    o multi2di() has a new option, `random', which specifies whether
      to resolve the multichotomies randomly (the default) or not.

    o prop.part() now returns an object of class "prop.part" for which
      there are print (to display a partition in a more friendly way)
      and summary (to extract the numbers) methods.

    o plot.phylo() has a new option, `show.tip.label', specifying
      whether to print the labels of the tips. The default is TRUE.

    o The code of nj() has been replaced by a faster C code: it is now
      about 10, 25, and 40 times faster for 50, 100, and 200 taxa,
      respectively.

    o write.nexus() now writes whether a tree is rooted or not.


BUG FIXES

    o Two bugs have been fixed in root(): unrooted trees are now
      handled corretly, and node labels are now output normally.

    o A bug was fixed in phymltest(): the executable couldn't be found
      in some cases.

    o Three bug have been fixed in ace(): computing the likelihood of
      ancestral states of discrete characters failed, custom models
      did not work, and the function failed with a null gradient (a
      warning message is now returned; this latter bug was also
      present in yule.cov() as well and is now fixed).

    o pic() hanged out when missing data were present: a message error
      is now returned.

    o A small bug was fixed in dist.dna() where the gamma correction
      was not always correctly dispatched.

    o plot.phylo() plotted correctly the root edge only when the tree
      was plotted rightwards: this works now for all directions.


OTHER CHANGES

    o dist.taxo() has been renamed as weight.taxo().

    o Various error and warning messages have been improved.



		CHANGES IN APE VERSION 1.7
NEW FEATURES

    o The new function ace() estimates ancestral character states for
      continuous characters (with ML, GLS, and contrasts methods), and
      discrete characters (with ML only) for any number of states.

    o The new function compar.ou() fits the Ornstein-Uhlenbeck model
      of directional evolution for continuous characters. The user
      specifies the node(s) of the tree where the character optimum
      changes.

    o The new function is.rooted() tests whether a tree (of class
      "phylo") is rooted.

    o The new function rcoal() generates random ultrametric trees with
      the possibility to specify the function that generates the
      inter-nodes distances.

    o The new function mrca() gives for all pairs of tips in a tree
      (and optionally nodes too) the most recent common ancestor.

    o nodelabels() has a new option `thermo' to plot proportions (up
      to three classes) on the nodes of a tree.

    o rtree() has been improved: it can now generate rooted or
      unrooted trees, and the mathematical function that generates the
      branch lengths may be specified by the user. The tip labels may
      be given directly in the call to rtree. The limit cases (n = 2,
      3) are now handled correctly.

    o dist.topo() has a new argument `method' with two choices: "PH85"
      for Penny and Henny's method (already available before and now
      the default), and "BHV01" for the geometric distance by Billera
      et al. (2001, Adv. Appl. Math. 27:733).

    o write.tree() has a new option, `digits', which specifies the
      number of digits to be printed in the Newick tree. By default
      digits = 10. The numbers are now always printed in decimal form
      (i.e., 1.0e-1 is now avoided).

    o dist.dna() can now compute the raw distances between pairs of
      DNA sequences by specifying model = "raw".

    o dist.phylo() has a new option `full' to possibly compute the
      distances among all tips and nodes of the tree. The default if
      `full = FALSE'.


BUG FIXES

    o Several bugs were fixed in all.equal.phylo().

    o dist.dna() did not handle correctly gaps ("-") in alignments:
      they are now considered as missing data.

    o rotate() did not work if the tips were not ordered: this is
      fixed.

    o mantel.test() returned NA in some special cases: this is fixed
      and the function has been improved and is now faster.

    o A bug was fixed in diversi.gof() where the calculation of A² was
      incorrect.

    o cherry() did not work correctly under some OSs (mainly Linux):
      this is fixed.

    o is.binary.tree() has been modified so that it works with both
      rooted and unrooted trees.

    o The documentation of theta.s() was not correct: this has been
      fixed.

    o plot.mst() did not work correctly: this is fixed.



		CHANGES IN APE VERSION 1.6


NEW FEATURES

    o The new function dist.topo() computes the topological distances
      between two trees.

    o The new function boot.phylo() performs a bootstrap analysis on
      phylogeny estimation.

    o The new functions prop.part() and prop.clades() analyse
      bipartitions from a series of trees.


OTHER CHANGES

    o read.GenBank() now uses the EFetch utility of NCBI instead of
      the usual Web interface: it is now much faster (e.g., 12 times
      faster to retrieve 8 sequences, 37 times for 60 sequences).


BUG FIXES

    o Several bugs were fixed in read.dna().

    o Several bugs were fixed in diversi.time().

    o is.binary.tree() did not work correctly if the tree has no edge
      lengths: this is fixed.

    o drop.tip() did not correctly propagated the `node.label' of a
      tree: this is fixed.



 		CHANGES IN APE VERSION 1.5


NEW FEATURES

    o Two new functions, as.matching.phylo() and as.phylo.matching(),
      convert objects between the classes "phylo" and "matching". The
      latter implements the representation of binary trees introduced by
      Diaconis and Holmes (1998; PNAS 95:14600). The generic function
      as.matching() has been introduced as well.

    o Two new functions, multi2di() and di2multi(), allow to resolve
      and collapse multichotomies with branches of length zero.

    o The new function nuc.div() computes the nucleotide diversity
      from a sample a DNA sequences.

    o dist.dna() has been completely rewritten with a much faster
      (particularly for large data sets) C code. Eight models are
      available: JC69, K80, F81, K81, F84, T92, TN93, and GG95 (the
      option `method' has been renamed `model'). Computation of variance
      is available for all models. A gamma-correction is possible for
      JC69, K80, F81, and TN93. There is a new option, pairwise.deletion,
      to remove sites with missing data on a pairwise basis. The option
      `GCcontent' has been removed.

    o read.GenBank() has a new option (species.names) which specifies
      whether to return the species names of the organisms in addition
      to the accession numbers of the sequences (this is the default
      behaviour).

    o write.nexus() can now write several trees in the same NEXUS file.

    o drop.tip() has a new option `root.edge' that allows to specify the
      new root edge if internal branches are trimmed.


BUG FIXES

    o as.phylo.hclust() failed if some labels had parentheses: this
      is fixed.

    o Several bugs were fixed in all.equal.phylo(). This function now
      returns the logical TRUE if the trees are identical but with
      different representations (a report was printed previously).

    o read.GenBank() did not correctly handle ambiguous base codes:
      this is fixed.


OTHER CHANGES

    o birthdeath() now returns an object of class "birthdeath" for
      which there is a print method.



		CHANGES IN APE VERSION 1.4


NEW FEATURES

    o The new function nj() performs phylogeny estimation with the
      neighbor-joining method of Saitou and Nei (1987; Mol. Biol.
      Evol., 4:406).

    o The new function which.edge() identifies the edges of a tree
      that belong to a group specified as a set of tips.

    o The new function as.phylo.phylog() converts an object of class
      "phylog" (from the package ade4) into an object of class
      "phylo".

    o The new function axisPhylo() draws axes on the side of a
      phylogeny plot.

    o The new function howmanytrees() calculates the number of trees
      in different cases and giving a number of tips.

    o write.tree() has a new option `multi.line' (TRUE by default) to
      write a Newick tree on several lines rather than on a single
      line.

    o The functionalities of zoom() have been extended. Several
      subtrees can be visualized at the same time, and they are marked
      on the main tree with colors. The context of the subtrees can be
      marked with the option `subtree' (see below).

    o drop.tip() has a new option `subtree' (FALSE by default) which
      specifies whether to output in the tree how many tips have been
      deleted and where.

    o The arguments of add.scale.bar() have been redefined and have
      now default values (see ?add.scale.bar for details). This
      function now works even if the plotted tree has no edge length.

    o plot.phylo() can now plot radial trees, but this does not take
      edge lengths into account.

    o In plot.phylo() with `type = "phylogram"', if the values of
      `edge.color' and `edge.width' are identical for sister-branches,
      they are propagated to the vertical line that link them.


BUG FIXES

    o Repeated calls to as.phylo.hclust() or as.hclust.phylo() made R
      crashing. This is fixed.

    o In plot.phylo(), the options `edge.color' and `edge.width' are
      now properly recycled; their default values are now "black" and
      1, respectively.

    o A bug has been fixed in write.nexus().


OTHER CHANGES

    o The function node.depth.edgelength() has been removed and
      replaced by a C code.



		CHANGES IN APE VERSION 1.3-1


NEW FEATURES

    o The new function nodelabels() allows to add labels to the nodes
      of a tree using text or plotting symbols in a flexible way.

    o In plot.phylo() the arguments `x.lim' and `y.lim' can now be two
      numeric values specifying the lower and upper limits on the x-
      and y-axes. This allows to leave some space on any side of the
      tree. If a single value is given, this is taken as the upper
      limit (as before).



		CHANGES IN APE VERSION 1.3


NEW FEATURES

    o The new function phymltest() calls the software PHYML and fits
      28 models of DNA sequence evolution. There are a print method to
      display likelihood and AIC values, a summary method to compute
      the hierarchical likelihood ratio tests, and a plot method to
      display graphically the AIC values of each model.

    o The new function yule.cov() fits the Yule model with covariates,
      a model where the speciation rate is affected by several species
      traits through a generalized linear model. The parameters are
      estimated by maximum likelihood.

    o Three new functions, corBrownian(), corGrafen(), and
      corMartins(), compute the expected correlation structures among
      species given a phylogeny under different models of evolution.
      These can be used for GLS comparative phylogenetic methods (see
      the examples). There are coef() and corMatrix() methods and an
      Initialize.corPhyl() function associated.

    o The new function compar.cheverud() implements Cheverud et al.'s
      (1985; Evolution 39:1335) phylogenetic comparative method.

    o The new function varcomp() estimates variance components; it has
      a plot method.

    o Two new functions, panel.superpose.correlogram() and
      plot.correlogramList(), allow to plot several phylogenetic
      correlograms.

    o The new function node.leafnumber() computes the number of leaves
      of a subtree defined by a particular node.

    o The new function node.sons() gets all tags of son nodes from a
      given parent node.

    o The new function compute.brlen() computes the branch lengths of
      a tree according to a specified method.

    o plot.phylo() has three new options: "cex" controls the size of
      the (tip and node) labels (thus it is no more needed to change
      the global graphical parameter), "direction" which allows to
      plot the tree rightwards, leftwards, upwards, or downwards, and
      "y.lim" which sets the upper limit on the y-axis.


BUG FIXES

    o Some functions which try to match tip labels and names of
      additional data (e.g. vector) are likely to fail if there are
      typing or syntax errors. If both series of names do not perfectly
      match, they are ignored and a warning message is now issued.
      These functions are bd.ext, compar.gee, pic. Their help pages
      have been clarified on this point.



		CHANGES IN APE VERSION 1.2-7


NEW FEATURES

    o The new function root() reroots a phylogenetic tree with respect
      to a specified outgroup.

    o The new function rotate() rotates an internal branch of a tree.

    o In plot.phylo(), the new argument "lab4ut" (labels for unrooted
      trees) controls the display of the tip labels in unrooted trees.
      This display has been greatly improved: the tip labels are now not
      expected to overlap with the tree (particularly if lab4ut =
      "axial"). In all cases, combining appropriate values of "lab4ut"
      and the font size (via "par(cex = )") should result in readable
      unrooted trees. See ?plot.phylo for some examples.

    o In drop.tip(), the argument `tip' can now be numeric or character.


BUG FIXES

    o drop.tip() did not work correctly with trees with no branch
      lengths: this is fixed.

    o A bug in plot.phylo(..., type = "unrooted") made some trees being
      plotted with some line crossings: this is now fixed.



		CHANGES IN APE VERSION 1.2-6


NEW FEATURES

    o Six new functions (Moran.I, correlogram.formula, discrete.dist,
      correlogram.phylo, dist.taxo, plot.correlogram) have been added
      to implement comparative methods with an autocorrelation approach.

    o A new data set describing some life history traits of Carnivores
      has been included.


BUG FIXES

    o A fix was made on mcmc.popsize() to conform to R 2.0.0.


OTHER CHANGES

    o When plotting a tree with plot.phylo(), the new default of the
      option `label.offset' is now 0, so the labels are always visible.



		CHANGES IN APE VERSION 1.2-5


NEW FEATURES

    o The new function bd.ext() fits a birth-death model with combined
      phylogenetic and taxonomic data, and estimates the corresponding
      speciation and extinction rates.


OTHER CHANGES

    o The package gee is no more required by ape but only suggested
      since only the function compar.gee() calls gee.



		CHANGES IN APE VERSION 1.2-4


NEW FEATURES

    o Four new functions (mcmc.popsize, extract.popsize, plot.popsize,
      and lines.popsize) implementing a new approach for inferring the
      demographic history from genealogies using a reversible jump
      MCMC have been introduced.

    o The unit of time in the skyline plot and in the new plots can
      now be chosen to be actual years, rather than substitutions.



		CHANGES IN APE VERSION 1.2-3


NEW FEATURES

    o The new function rtree() generates a random binary tree with or
      without branch lengths.

    o Two new functions for drawing lineages-through-time (LTT) plots
      are provided: ltt.lines() adds a LTT curve to an existing plot,
      and mltt.plot() does a multiple LTT plot giving several trees as
      arguments (see `?ltt.plot' for details).


BUG FIXES

    o Some taxon names made R crashing when calling as.phylo.hclust():
      this is fixed.

    o dist.dna() returned an error with two identical DNA sequences
      (only using the Jukes-Cantor method returned 0): this is fixed.


OTHER CHANGES

    o The function dist.phylo() has been re-written using a different
      algorithm: it is now about four times faster.

    o The code of branching.times() has been improved: it is now about
      twice faster.



		CHANGES IN APE VERSION 1.2-2


NEW FEATURES

    o The new function seg.sites() finds the segregating sites in a
      sample of DNA sequences.


BUG FIXES

    o A bug introduced in read.tree() and in read.nexus() with version
      1.2-1 was fixed.

    o A few errors were corrected and a few examples were added in the
      help pages.



		CHANGES IN APE VERSION 1.2-1


NEW FEATURES

    o plot.phylo() can now draw the edge of the root of a tree if it
      has one (see the new option `root.edge', its default is FALSE).


BUG FIXES

    o A bug was fixed in read.nexus(): files with semicolons inside
      comment blocks were not read correctly.

    o The behaviour of read.tree() and read.nexus() was corrected so
      that tree files with badly represented root edges (e.g., with
      an extra pair of parentheses, see the help pages for details)
      are now correctly represented in the object of class "phylo";
      a warning message is now issued.



		CHANGES IN APE VERSION 1.2


NEW FEATURES

    o plot.phylo() has been completely re-written and offers several
      new functionalities. Three types of trees can now be drawn:
      phylogram (as previously), cladogram, and unrooted tree; in
      all three types the branch lengths can be drawn using the edge
      lengths of the phylogeny or not (e.g., if the latter is absent).
      The vertical position of the nodes can be adjusted with two
      choices (see option `node.pos'). The code has been re-structured,
      and two new functions (potentially useful for developpers) are
      documented separately: node.depth.edgelength() and node.depth();
      see the respective help pages for details.

    o The new function zoom() allows to explore very large trees by
      focusing on a small portion of it.

    o The new function yule() fits by maximum likelihood the Yule model
      (birth-only process) to a phylogenetic tree.

    o Support for writing DNA sequences in FASTA format has been
      introduced in write.dna() (support for reading sequences in
      this format was introduced in read.dna() in version 1.1-2).
      The function has been completely re-written, fixing some bugs
      (see below); the default behaviour is no more to display the
      sequences on the standard output. Several options have been
      introduced to control the sequence printing in a flexible
      way. The help page has been extended.

    o A new data set is included: a supertree of bats in NEXUS format.


BUG FIXES

    o In theta.s(), the default of the option `variance' has
      been changed to `FALSE' (as was indicated in the help page).

    o Several bugs were fixed in the code of all.equal.phylo().

    o Several bugs were fixed in write.dna(), particularly this
      function did not work with `format = "interleaved"'.

    o Various errors were corrected in the help pages.


OTHER CHANGES

    o The argument names of as.hclust.phylo() have been changed
      from "(phy)" to "(x, ...)" to conform to the definition of
      the corresponding generic function.

    o gamma.stat() has been renamed gammaStat() to avoid confusion
      since gamma() is a generic function.



		CHANGES IN APE VERSION 1.1-3


BUG FIXES

    o base.freq() previously did not return a value of 0 for
      bases absent in the data (e.g., a vector of length 3 was
      returned if one base was absent). This is now fixed (a
      vector of length 4 is always returned).

    o Several bugs were fixed in read.nexus(), including that this
      function did not work in this absence of a "TRANSLATE"
      command in the NEXUS file, and that the commands were
      case-sensitive.



		CHANGES IN APE VERSION 1.1-2


NEW FEATURES

    o The Tamura and Nei (1993) model of DNA distance is now implemented
      in dist.dna(): five models are now available in this function.

    o A new data set is included: a set of 15 sequences of the
      cytochrome b mitochondrial gene of the woodmouse (Apodemus
      sylvaticus).


BUG FIXES

    o A bug in read.nexus() was fixed.

    o read.dna() previously did not work correctly in most cases.
      The function has been completely re-written and its help page
      has been considerably extended (see ?read.dna for details).
      Underscores (_) in taxon names are no more replaced with
      spaces (this behaviour was undocumented).

    o A bug was fixed in write.dna().



		CHANGES IN APE VERSION 1.1-1


BUG FIXES

    o A bug in read.tree() introduced in APE 1.1 was fixed.

    o A bug in compar.gee() resulted in an error when trying to fit
      a model with `family = "binomial"'. This is now fixed.



 		CHANGES IN APE VERSION 1.1


NEW FEATURES

    o The Klastorin (1982) method as suggested by Misawa and Tajima
      (2000, Mol. Biol. Evol. 17:1879-1884) for classifying genes
      on the basis of phylogenetic trees has been implemented (see
      the function klastorin()).

    o Functions have been added to convert APE's "phylo" objects in
      "hclust" cluster objects and vice versa (see the help page of
      as.phylo for details).

    o Three new functions, ratogram(), chronogram() and NPRS.criterion(),
      are introduced for the estimation of absolute evolutionary rates
      (ratogram) and dated clock-like trees (chronogram) from
      phylogenetic trees using the non-parametric rate smoothing approach
      by MJ Sanderson (1997, Mol. Biol. Evol. 14:1218-1231).

    o A summary method is now provided printing a summary information on a
      phylogenetic tree with, for instance, `summary(tree)'.

    o The behaviour of read.tree() was changed so that all spaces and
      tabulations in tree files are now ignored. Consequently, spaces in tip
      labels are no more allowed. Another side effect is that read.nexus()
      now does not replace the underscores (_) in tip labels with spaces
      (this behaviour was undocumented).

    o The function plot.phylo() has a new option (`underscore') which
      specifies whether the underscores in tip labels should be written on
      the plot as such or replaced with spaces (the default).

    o The function birthdeath() now computes 95% confidence intervals of
      the estimated parameters using profile likelihood.

    o Three new data sets are included: a gene tree estimated from 36
      landplant rbcL sequences, a gene tree estimated from 32 opsin
      sequences, and a gene tree for 50 BRCA1 mammalian sequences.


BUG FIXES

    o A bug was fixed in dist.gene() where nothing was returned.

    o A bug in plot.mst() was fixed.

    o A bug in vcv.phylo() resulted in false correlations when the
      option `cor = TRUE' was used (now fixed).



		CHANGES IN APE VERSION 1.0


NEW FEATURES

    o Two new functions, read.dna() and write.dna(), read/write in a file
      DNA sequences in interleaved or in sequential format.

    o Two new functions, read.nexus() and write.nexus(), read/write trees
      in a NEXUS file.

    o The new function bind.tree() allows to bind two trees together,
      possibly handling root edges to give internal branches.

    o The new function drop.tip() removes the tips in a phylogenetic tree,
      and trims (or not) the corresponding internal branches.

    o The new function is.ultrametric() tests if a tree is ultrametric.

    o The function plot.phylo() has more functionalities such as drawing the
      branches with different colours and/or different widths, showing the
      node labels, controling the position and font of the labels, rotating
      the labels, and controling the space around the plot.

    o The function read.tree() can now read trees with no branch length,
      such as "(a,b),c);". Consequently, the element `edge.length' in
      objects of class "phylo" is now optional.

    o The function write.tree() has a new default behaviour: if the default
      for the option `file' is used (i.e. file = ""), then a variable of
      mode character containing the tree in Newick format is returned which
      can thus be assigned (e.g., tree <- write.tree(phy)).

    o The function read.tree() has a new argument `text' which allows
      to read the tree in a variable of mode character.

    o A new data set is included: the phylogenetic relationships among
      the orders of birds from Sibley and Ahlquist (1990).



		CHANGES IN APE VERSION 0.2-1


BUG FIXES

    o Several bugs were fixed in the help pages.



		CHANGES IN APE VERSION 0.2


NEW FEATURES

    o The function write.tree() writes phylogenetic trees (objects of class
      "phylo") in an ASCII file using the Newick parenthetic format.

    o The function birthdeath() fits a birth-death model to branching times
      by maximum likelihood, and estimates the corresponding speciation and
      extinction rates.

    o The function scale.bar() adds a scale bar to a plot of a phylogenetic
      tree.

    o The function is.binary.tree() tests whether a phylogeny is binary.

    o Two generic functions, coalescent.intervals() and collapsed.intervals(),
      as well as some methods are introduced.

    o Several functions, including some generics and methods, for computing
      skyline plot estimates (classic and generalized) of effective
      population size through time are introduced and replace the function
      skyline.plot() in version 0.1.

    o Two data sets are now included: the phylogenetic relationships among
      the families of birds from Sibley and Ahlquist (1990), and an
      estimated clock-like phylogeny of HIV sequences sampled in the
      Democratic Republic of Congo.


DEPRECATED & DEFUNCT

    o The function skyline.plot() in ape 0.1 has been deprecated and
      replaced by more elaborate functions (see above).


BUG FIXES

    o Two important bugs were fixed in plot.phylo(): phylogenies with
      multichotomies not at the root or not with only terminal branches,
      and phylogenies with a single node (i.e. only terminal branches)
      did not plot. These trees should be plotted correctly now.

    o Several bugs were fixed in diversi.time() in the computation of
      AICs and LRTs.

    o Various errors were corrected in the help pages.
